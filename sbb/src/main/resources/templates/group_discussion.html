<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      th:replace="layout :: layout(~{::body})">
<body>
<div>
    <a th:href="@{/groups/{id}(id=${group.id})}" class="btn btn-outline" style="margin-bottom:10px;">← 그룹으로 돌아가기</a>
    <h1 class="page-title">그룹 토론</h1>
    <p style="margin-top:-6px; color:#6b7280;">
        <span th:text="${group.name}"></span> · <span th:text="${question.questionText}">문제</span>
    </p>

    <div class="card">
        <h3 style="margin:0 0 8px;">댓글</h3>
        <div style="display:flex; flex-direction:column; gap:8px;">
            <div th:each="item : ${comments}"
                 style="padding:10px; border:1px solid #e5e7eb; border-radius:10px; display:flex; gap:10px; align-items:flex-start;">
                <div style="font-size:20px;"> 
                    <span th:text="${item.user.avatar != null ? item.user.avatar : '🧑'}">🧑</span>
                </div>
                <div style="flex:1;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <strong class="comment-username" th:text="${item.user.username}">user</strong>
                        <span style="color:#9ca3af; font-size:12px;"
                          th:text="${#temporals.format(item.createdAt, 'yyyy.MM.dd HH:mm')}">date</span>
                    </div>
                    <div style="margin-top:6px; white-space:pre-wrap;" th:text="${item.content}"></div>
                </div>
            </div>
            <div th:if="${#lists.isEmpty(comments)}" style="color:#6b7280;">첫 댓글을 남겨 보세요.</div>
        </div>

        <form th:action="@{/groups/{groupId}/discussion/{questionId}(groupId=${group.id},questionId=${question.id})}"
              method="post"
              style="margin-top:12px; display:flex; gap:8px; align-items:flex-start;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <textarea name="content" rows="2" required
                      style="flex:1; padding:10px; border:1px solid #d1d5db; border-radius:10px; resize:vertical;"
                      placeholder="그룹원들과 생각을 나눠 보세요"></textarea>
            <button type="submit" class="btn" style="padding:10px 14px;">등록</button>
        </form>
    </div>
</div>
</body>
</html>
