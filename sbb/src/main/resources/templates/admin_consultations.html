<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="layout :: layout(~{::body})">
<body>
<div class="page-card">
    <div class="page-header">
        <div>
            <div class="pill">관리자 전용</div>
            <h1 class="page-title">상담 요청</h1>
            <p class="muted">방문/전화 상담 요청이 접수된 순서대로 표시됩니다.</p>
        </div>
    </div>

    <div class="table-card">
        <div class="table-head">
            <div>구분</div>
            <div>내용</div>
            <div>시각</div>
            <div>전화/응대</div>
        </div>
        <div class="table-row" th:each="c : ${consultations}">
            <div class="pill-soft" th:text="${c.type}">VISIT</div>
            <div>
                <div class="title-md" th:text="${c.user != null ? c.user.username : '비회원'}">user</div>
                <div th:if="${c.message}" th:text="${c.message}" style="margin-top:4px; white-space:pre-wrap;"></div>
            </div>
            <div class="muted" th:text="${#temporals.format(c.createdAt, 'yyyy-MM-dd HH:mm')}">time</div>
            <div>
                <form th:action="@{'/admin/consultations/' + ${c.id} + '/toggle'}" method="post" style="display:flex; align-items:center; gap:6px;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <input type="checkbox" name="contacted" th:checked="${c.contacted}" onchange="this.form.submit()">
                    <label style="font-size:13px;" th:text="${c.contacted ? '완료' : '대기'}">대기</label>
                </form>
            </div>
        </div>
    </div>
</div>
</body>
</html>
