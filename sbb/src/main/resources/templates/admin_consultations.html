<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="layout :: layout(~{::body})">
<body>
<div class="page-card">
    <div class="page-header">
        <div>
            <div class="pill">관리자 전용</div>
            <h1 class="page-title">상담 요청</h1>
            <p class="muted">방문/전화 상담 요청이 접수된 순서대로 표시됩니다.</p>
        </div>
    </div>

    <div style="display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));">
        <div th:each="c : ${consultations}" class="card" style="padding:14px; border:1px solid #e5e7eb; border-radius:14px; box-shadow:0 8px 18px rgba(0,0,0,0.05); display:flex; flex-direction:column; gap:8px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div class="pill-soft" th:text="${c.type}">VISIT</div>
                <div class="muted" th:text="${#temporals.format(c.createdAt, 'yyyy-MM-dd HH:mm')}">time</div>
            </div>
            <div>
                <div class="title-md" th:text="${c.user != null ? c.user.username : '비회원'}">user</div>
                <div th:if="${c.message}" th:text="${c.message}" style="margin-top:4px; white-space:pre-wrap;"></div>
            </div>
            <form th:action="@{'/admin/consultations/' + ${c.id} + '/toggle'}" method="post" style="display:flex; align-items:center; gap:8px; justify-content:flex-end;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                <input type="checkbox" name="contacted" th:checked="${c.contacted}" onchange="this.form.submit()">
                <label style="font-size:13px;" th:text="${c.contacted ? '완료' : '대기'}">대기</label>
                <button type="submit" class="btn btn-outline" style="padding:6px 10px;">상태 변경</button>
            </form>
        </div>
    </div>
</div>
</body>
</html>
